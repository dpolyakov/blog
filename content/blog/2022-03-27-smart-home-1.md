---
title: '–£–º–Ω—ã–π –¥–æ–º: —Å–æ–±–∏—Ä–∞–µ–º –Ω–µ–¥–æ–≥–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–ø–ª–µ–Ω–∏–µ–º.'
date: '2020-03-27 12:00:00'
author: dima
id: '616'
type: post
slug: smart-home-otoplenie-na-baze-xiaomi-i-homeassistant
categories:
  - –£–º–Ω—ã–π –¥–æ–º
tags:
  - xiaomi
  - BlitzWolf
  - –≥–∞–π–¥
  - —Å–¥–µ–ª–∞–π —Å–∞–º
  - zigbee
  - openwrt
  - zigbee2mqtt
  - homeassistant
---

–•–æ—á—É —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –≤–∞–º –ø—Ä–æ —Å–≤–æ—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —É–º–Ω–æ–≥–æ –¥–æ–º–∞ –Ω–∞ –¥–∞—á–µ. 

‚ö†Ô∏è¬†–°—Ä–∞–∑—É –¥–∏—Å–∫–ª–µ–π–º–µ—Ä: —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ–¥–æ–π–¥—ë—Ç —Ç–µ–º, –∫—Ç–æ —Ö–æ—Ç—è –±—ã –ø–∞—Ä—É —Ä–∞–∑ –¥–µ—Ä–∂–∞–ª –ø–∞—è–ª—å–Ω–∏–∫ –≤ —Ä—É–∫–∞—Ö, –∞ —Ç–∞–∫ –∂–µ –∏–º–µ–µ—Ç –±–∞–∑–æ–≤—ã–µ –∑–Ω–∞–Ω–∏—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ unix-–ø–æ–¥–æ–±–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏. –¢–æ –µ—Å—Ç—å —Ç–∞–∫–æ–π –≥–∏–∫–æ–≤—Å–∫–∏–π –≤–∞—Ä–∏–∞–Ω—Ç. 

–ï—Å–ª–∏ –¥–ª—è –≤–∞—Å —ç—Ç–æ —Ç–µ–º–Ω—ã–π –ª–µ—Å, —Ç–æ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –≥–æ—Ç–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã –æ—Ç –≠–∫—Ç–æ–∫–æ–Ω—Ç—Ä–æ–ª–∞ –∏ –∞—è–∫—Å–∞. 

–û–¥–Ω–æ –∏–∑ –≥–ª–∞–≤–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π ‚Äî –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å. –£–º–Ω—ã–π –¥–æ–º –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ 4g –Ω–µ –æ—á–µ–Ω—å —Å—Ç–∞–±–∏–ª–µ–Ω. –ï—Å–ª–∏ —É –≤–∞—Å –ø—Ä–æ–≤–æ–¥–Ω–æ–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä, —Ç–æ –º–æ–∂–µ—Ç –≤–ø–æ–ª–Ω–µ –ø–æ–¥–æ–π—Ç–∏ —Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –±–∞–∑–µ Xiaomi –∏–ª–∏ Tuya, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ ¬´–æ–±–ª–∞–∫–æ¬ª. 

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
üéõÔ∏è¬†–ù–∞—á–Ω–µ–º —Å –≥–ª–∞–≤–Ω–æ–≥–æ: —Ü–µ–Ω—Ç—Ä —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É–º–Ω—ã–º –¥–æ–º–æ–º. –í –º–æ—ë–º —Å–ª—É—á–∞–µ —ç—Ç–æ —à–ª—é–∑ **Xiaomi DGNWG05LM** (–æ–Ω –∂–µ **ZHTZ02LM**), –ø–µ—Ä–µ–ø—Ä–æ—à–∏—Ç—ã–π –≤ OpenWrt. –î–ª—è –ø–µ—Ä–µ–ø—Ä–æ—à–∏–≤–∫–∏ –≤–∞–º –∏ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è {{<admidad program="aliexpress" id="32825753754" title="–ø–∞—è–ª—å–Ω–∏–∫" >}}, —á—Ç–æ–±—ã –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ UART —Ä–∞–∑—ä—ë–º—É. –ê —Ç–∞–∫ –∂–µ usb2uart {{<admidad program="aliexpress" id="4000120687489" title="–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä" >}}. –®–ª—é–∑ –º–æ–∂–Ω–æ –≤—ã–≥–æ–¥–Ω–æ –∫—É–ø–∏—Ç—å –≤ –Ω–∞–±–æ—Ä–µ —Å –¥–∞—Ç—á–∏–∫–∞–º–∏ –≤ [DNS](https://www.dns-shop.ru/product/0fdead0514a03332/komplekt-umnogo-doma-xiaomi-zhtz02lm/). 

–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø–µ—Ä–µ–ø—Ä–æ—à–∏–≤–∫–µ –µ—Å—Ç—å –Ω–∞ —Å–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç–∞ [openilumi](http://openlumi.github.io). 
{{< figure src="https://openlumi.github.io/images/uart_pinout.jpg" >}}

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞
–ü–æ—Å–ª–µ –ø–µ—Ä–µ–ø—Ä–æ—à–∏–≤–∫–∏ —è —É—Å—Ç–∞–Ω–æ–≤–∏–ª –Ω–∞ —à–ª—é–∑ [**Homeassistant**](https://github.com/openlumi/homeassistant_on_openwrt) ‚Äî —ç—Ç–æ —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É–º–Ω—ã–º –¥–æ–º–æ–º —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∫–æ–¥–æ–º. –ì–∞–π–¥ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –≤—Å—ë —Ç–∞–º –∂–µ. –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ –ø–æ–Ω—è—Ç–Ω–æ, —Ç–æ –µ—Å—Ç—å [—á–∞—Ç](https://t.me/xiaomi_gw_hack), –≥–¥–µ —ç–Ω—Ç—É–∑–∏–∞—Å—Ç—ã –º–æ–≥—É—Ç –ø–æ–º–æ—á—å. 

–û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ –º–æ–µ–≥–æ ¬´—É–º–Ω–æ–≥–æ –¥–æ–º–∞¬ª ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ –Ω—É–∂–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã. –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω—ã –¥–∞—Ç—á–∏–∫–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∏ —Ä–æ–∑–µ—Ç–∫–∏. 

üå°Ô∏è¬†–û–¥–∏–Ω –¥–∞—Ç—á–∏–∫ –µ—Å—Ç—å –≤ –Ω–∞–±–æ—Ä–µ. –¢–∞–∫ –∂–µ —è –¥–æ–∫—É–ø–∏–ª {{<admidad program="aliexpress" id="1005004744541750" title="Aqara MCCGQ11LM" >}}. –û–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É zigbee –∏ –±–µ–∑ –ø—Ä–æ–±–ª–µ–º –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è –∫ homeassistant —á–µ—Ä–µ–∑ zigbee2mqtt. 

üîå¬†–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –º—ã –∑–Ω–∞–µ–º, –¥–∞–≤–∞–π—Ç–µ –Ω–∞—É—á–∏–º—Å—è –µ—é —É–ø—Ä–∞–≤–ª—è—Ç—å. –î–ª—è —ç—Ç–æ–π —Ü–µ–ª–∏ —è –∫—É–ø–∏–ª –∫–æ–∑–µ—Ç–∫–∏ {{<admidad program="aliexpress" id="4001153556759" title="BlitzWolf BW-SHP13" >}}. –û–Ω–∏ —Ç–∞–∫ –∂–µ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ zigbee, —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Å–≤–æ—ë —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–∞ –∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –Ω–∞–≥—Ä—É–∑–∫–æ–π –æ—Ç –∫–æ–Ω–≤–µ–∫—Ç–æ—Ä–æ–≤. 

–í homeassistant —è –æ–±—ä–µ–¥–∏–Ω–∏–ª —Ä–æ–∑–µ—Ç–∫–∏ —Å –¥–∞—Ç—á–∏–∫–∞–º–∏ –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Ç–µ—Ä–º–æ—Å—Ç–∞—Ç—ã. –¢–µ–ø–µ—Ä—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–∞–¥–∞—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –¥–ª—è —Ä–µ–∂–∏–º–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∏ –∫–æ–≥–¥–∞ –≤—ã –¥–æ–º–∞. 
–î–ª—è —ç—Ç–æ–≥–æ –≤ `configuration.yaml` —Ö–æ—É–º–∞—Å—Å–∏—Å—Ç–∞–Ω—Ç–∞ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫—É—é —Å–µ–∫—Ü–∏—é:
```yaml
climate:
  - platform: generic_thermostat
    name: bedroom
    unique_id: thermostat_bedroom
    # –≤ heater: —É–∫–∞–∑—ã–≤–∞–µ–º id —Ä–æ–∑–µ—Ç–∫–∏
    heater: switch.0xcc86ecfffe4eaf38 
    # –≤ target_sensor id —Å–µ–Ω—Å–æ—Ä–∞ —Å –¥–∞—Ç—á–∏–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
    target_sensor: sensor.comfort_bedroom_temperature
    min_temp: 0
    max_temp: 25
    ac_mode: false
    target_temp: 22
    cold_tolerance: 0.3
    hot_tolerance: 0
    min_cycle_duration:
      seconds: 5
    keep_alive:
      minutes: 3
    initial_hvac_mode: "heat"
    away_temp: 16
    precision: 0.1
```

## –ó–∞—á–µ–º —Ç–∞–∫ —Å–ª–æ–∂–Ω–æ? 
–Ø –≤—ã–±—Ä–∞–ª —Ç–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ –¥–≤—É–º –ø—Ä–∏—á–∏–Ω–∞–º:
‚óæ¬†—Ñ–∏–Ω–∞–Ω—Å—ã: –æ–ø–∏—Å–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –±–∞–∑–µ –≠–∫—Ç–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–∞ —Å—Ç–æ–∏—Ç –±–æ–ª—å—à–µ 40000. –£ –º–µ–Ω—è –ø–æ–ª—É—á–∏–ª–æ—Å—å –æ–∫–æ–ª–æ 20000.

‚óæ¬†–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä–µ—Å –∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –æ–ø—ã—Ç. 

–ù–∞ —ç—Ç–æ–º –≤—Å—ë, –≤–æ–ø—Ä–æ—Å —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑–±–µ—Ä—É –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Å—Ç–µ. 
